<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gym Assistant</title>
    <style>
        body { font-family: sans-serif; max-width: 600px; margin: 40px auto; padding: 20px; background: #111; color: #eee; }
        input { width: 100%; padding: 12px; font-size: 16px; background: #222; border: 2px solid #444; color: #eee; margin-bottom: 10px; }
        button { width: 100%; padding: 12px; font-size: 16px; background: #0f8; border: none; color: #000; font-weight: bold; cursor: pointer; }
        #msg { padding: 15px; background: #222; margin: 20px 0; border-left: 4px solid #0f8; }
        .item { background: #222; padding: 10px; margin: 10px 0; border-left: 3px solid #444; }
        .ex { color: #0f8; font-weight: bold; }
        .dt { color: #888; font-size: 12px; }
    </style>
</head>
<body>
    <h1>ðŸ’ª (Dead Simple) Gym Log</h1>
    <input id="i" placeholder="bench 8, 8, 7 x 100" autofocus>
    <button onclick="log()">Log</button>
    <div id="msg"></div>
    <div id="hist"></div>
    <script>
        const get = () => JSON.parse(localStorage.getItem('w') || '[]');
        const save = w => localStorage.setItem('w', JSON.stringify([...get(), w]));
        function isHeavier(current, previous) {
            const toKg = (wt, unit) => 
                (unit === 'lbs' || unit === 'lb') ? wt * 0.453592 : wt;
            return toKg(current.wt, current.unit) > toKg(previous.wt, previous.unit);
        }
        
        function parse(t) {
            t = t.toLowerCase();
            const m = t.match(/(.+?)\s+([\d,\s]+)\s*x\s*(\d+)\s*(lbs?|kg)?/);
            if (!m) return null;
            return {
                ex: m[1].trim(),
                reps: m[2].split(',').map(r => +r.trim()),
                wt: +m[3],
                unit: m[4] || 'kg',
                date: Date.now()
            };
        }
        
        function log() {
            const input = document.getElementById('i');
            const w = parse(input.value);
            if (!w) { msg('Bad format. Try: "squat 5,5 x 100 kg" or "squat 10,8,6 x 225 lbs"'); return; }
            
            const hist = get().filter(x => x.ex === w.ex);
            const last = hist[hist.length - 1];
            
            save(w);
            
            if (!last) {
                msg(`${w.ex}: First time! ðŸŽ‰`);
            } else {
                const curr = w.reps.reduce((a,b) => a+b, 0);
                const prev = last.reps.reduce((a,b) => a+b, 0);
                const comp = isHeavier(w, last) ? 'ðŸ’ª Heavier!' : 
                    curr > prev ? 'ðŸ“ˆ More reps!' : 
                    isHeavier(last, w) ? 'ðŸ˜“ Lighter' :
                    curr < prev ? 'ðŸ˜“ Fewer reps' : 'ðŸ‘ Same';
                msg(`Last: ${last.wt}${last.unit} x ${last.reps.join(',')}. ${comp}`);
            }
            
            input.value = '';
            show();
        }
        
        function msg(t) { document.getElementById('msg').textContent = t; }
        
        function show() {
            const h = get().slice(-10).reverse();
            document.getElementById('hist').innerHTML = h.map(w => 
                `<div class="item">
                    <div class="ex">${w.ex}</div>
                    <div>${w.wt}${w.unit} Ã— ${w.reps.join(', ')}</div>
                    <div class="dt">${new Date(w.date).toLocaleString()}</div>
                </div>`
            ).join('');
        }
        
        document.getElementById('i').addEventListener('keydown', e => {
            if (e.key === 'Enter') {
                e.preventDefault();
                log();
            }
        });
        show();
    </script>
</body>
</html>
